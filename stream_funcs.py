# import mysql.connector
import pandas as pd
import streamlit as st

@st.cache_data

def countries_from_multiselect(multilist):
    mapping = {"ðŸ‡¦ðŸ‡¹ - Austria": ["Austria"],
               "ðŸ‡§ðŸ‡ª - Belgium": ["Belgium"],
               "ðŸ‡§ðŸ‡¬ - Bulgaria": ["Bulgaria"],
               "ðŸ‡­ðŸ‡· - Croatia": ["Croatia"],
                "ðŸ‡¨ðŸ‡¾ - Cyprus": ["Cyprus"],
               "ðŸ‡¨ðŸ‡¿ - Czech Republic": ["Czech Republic"],
               "ðŸ‡©ðŸ‡° - Denmark": ["Denmark"],
                "ðŸ‡ªðŸ‡ª - Estonia": ["Estonia"],
               "ðŸ‡«ðŸ‡® - Finland": ["Finland"],
               "ðŸ‡«ðŸ‡· - France": ["France"],
               "ðŸ‡©ðŸ‡ª - Germany": ["Germany"],
                "ðŸ‡¬ðŸ‡· - Greece": ["Greece"],
               "ðŸ‡­ðŸ‡º - Hungary": ["Hungary"],
               "ðŸ‡®ðŸ‡ª - Ireland": ["Ireland"],
               "ðŸ‡®ðŸ‡¹ - Italy": ["Italy"],
                "ðŸ‡±ðŸ‡» - Latvia": ["Latvia"],
               "ðŸ‡±ðŸ‡¹ - Lithuania": ["Lithuania"],
               "ðŸ‡±ðŸ‡º - Luxembourg": ["Luxembourg"],
               "ðŸ‡²ðŸ‡¹ - Malta": ["Malta"],
                "ðŸ‡³ðŸ‡± - Netherlands": ["Netherlands"],
               "ðŸ‡µðŸ‡± - Poland": ["Poland"],
               "ðŸ‡µðŸ‡¹ - Portugal": ["Portugal"],
                "ðŸ‡·ðŸ‡´ - Romania": ["Romania"],
               "ðŸ‡¸ðŸ‡° - Slovakia": ["Slovakia"],
               "ðŸ‡¸ðŸ‡® - Slovenia": ["Slovenia"],
               "ðŸ‡ªðŸ‡¸ - Spain": ["Spain"],
                "ðŸ‡¸ðŸ‡ª - Sweden": ["Sweden"],
               "ðŸ‡¬ðŸ‡§ - United Kingdom": ["United Kingdom"],
               "ðŸ‡¦ðŸ‡º - Australia": ["Australia"],
                "ðŸ‡¨ðŸ‡¦ - Canada": ["Canada"],
               "ðŸ‡¨ðŸ‡³ - China": ["China"],
               "ðŸ‡­ðŸ‡° - Hong Kong": ["Hong Kong"],
                "ðŸ‡®ðŸ‡³ - India": ["India"],
               "ðŸ‡®ðŸ‡© - Indonesia": ["Indonesia"],
               "ðŸ‡¯ðŸ‡µ - Japan": ["Japan"],
               "ðŸ‡²ðŸ‡¾ - Malaysia": ["Malaysia"],
                "ðŸ‡²ðŸ‡½ - Mexico": ["Mexico"],
               "ðŸ‡³ðŸ‡¿ - New Zealand": ["New Zealand"],
               "ðŸ‡µðŸ‡­ - Philippines": ["Philippines"],
                "ðŸ‡¸ðŸ‡¬ - Singapore": ["Singapore"],
               "ðŸ‡°ðŸ‡· - South Korea": ["South Korea"],
               "ðŸ‡¹ðŸ‡¼ - Taiwan": ["Taiwan"],
               "ðŸ‡¹ðŸ‡­ - Thailand": ["Thailand"],
               "ðŸ‡¦ðŸ‡· - Argentina": ["Argentina"],
               "ðŸ‡§ðŸ‡· - Brazil": ["Brazil"],
                "ðŸ‡¨ðŸ‡± - Chile": ["Chile"],
               "ðŸ‡¨ðŸ‡´ - Colombia": ["Colombia"],
               "ðŸ‡ªðŸ‡¨ - Ecuador": ["Ecuador"],
               "ðŸ‡µðŸ‡ª - Peru": ["Peru"],
                "ðŸ‡¿ðŸ‡¦ - South Africa": ["South Africa"],
               "ðŸ‡¹ðŸ‡· - Turkey": ["Turkey"],
               "ðŸ‡ºðŸ‡¾ - Uruguay": ["Uruguay"],
                "ðŸ‡»ðŸ‡³ - Vietnam": ["Vietnam"],
               "ðŸ‡¦ðŸ‡ª - United Arab Emirates": ["United Arab Emirates"],
               "ðŸ‡¦ðŸ‡« - Afghanistan": ["Afghanistan"],
                "ðŸ‡¦ðŸ‡± - Albania": ["Albania"],
               "ðŸ‡©ðŸ‡¿ - Algeria": ["Algeria"],
               "ðŸ‡¦ðŸ‡´ - Angola": ["Angola"],
                "ðŸ‡¦ðŸ‡² - Armenia": ["Armenia"],
               "ðŸ‡¦ðŸ‡¼ - Aruba": ["Aruba"],
               "ðŸ‡µðŸ‡° - Pakistan": ["Pakistan"],
                "ðŸ‡¦ðŸ‡¿ - Azerbaijan": ["Azerbaijan"],
               "ðŸ‡§ðŸ‡­ - Bahrain": ["Bahrain"],
               "ðŸ‡§ðŸ‡© - Bangladesh": ["Bangladesh"],
                "ðŸ‡§ðŸ‡¾ - Belarus": ["Belarus"],
               "ðŸ‡§ðŸ‡¯ - Benin": ["Benin"],
               "ðŸ‡§ðŸ‡´ - Bolivia": ["Bolivia"],
                "ðŸ‡§ðŸ‡¦ - Bosnia and Herzegovina": ["Bosnia and Herzegovina"],
               "ðŸ‡§ðŸ‡¼ - Botswana": ["Botswana"],
                "ðŸ‡§ðŸ‡« - Burkina Faso": ["Burkina Faso"],
               "ðŸ‡§ðŸ‡® - Burundi": ["Burundi"],
               "ðŸ‡°ðŸ‡­ - Cambodia": ["Cambodia"],
                "ðŸ‡¨ðŸ‡² - Cameroon": ["Cameroon"],
               "ðŸ‡¨ðŸ‡« - Central African Republic": ["Central African Republic"],
               "ðŸ‡¹ðŸ‡© - Chad":[ "Chad"],
                "ðŸ‡°ðŸ‡² - Comoros": ["Comoros"],
               "ðŸ‡¨ðŸ‡© - Congo": ["Congo"],
               "ðŸ‡¨ðŸ‡· - Costa Rica": ["Costa Rica"],
                "ðŸ‡¨ðŸ‡® - Cote d'Ivoire": ["Cote d'Ivoire"],
               "ðŸ‡¨ðŸ‡º - Cuba": ["Cuba"],
                "ðŸ‡ºðŸ‡¸ - United States": ['USA', 'US', 'UNITED STATES', 'UNITED STATES OF AMERICA'],
               'America': ['CANADA', 'MEXICO',' GUATEMALA', 'EL SALVADOR', 'COSTA RICA', 'PANAMA', 'HONDURAS', 'NICARAGUA',
                                   'BELIZE', 'BRAZIL', 'ARGENTINA', 'PERU', 'COLOMBIA', 'CHILE', 'ECUADOR',
                                 'VENEZUELA, BOLIVARIAN REPUBLIC OF', 'PARAGUAY', 'URUGUAY',
                                 'BOLIVIA, PLURINATIONAL STATE OF', 'GUYANA', 'SURINAME', 'BOLIVARIAN REPUBLIC OF',
                                 'BOLIVIA', 'FRENCH GUIANA'],
               'Caribbean': ['DOMINICAN REPUBLIC', 'CUBA', 'JAMAICA', 'BAHAMAS', 'TRINIDAD AND TOBAGO', 'BARBADOS',
                             'ST VINCENT', 'PUERTO RICO'],
               'South America': ['BRAZIL', 'ARGENTINA', 'PERU', 'COLOMBIA', 'CHILE', 'ECUADOR',
                                 'VENEZUELA, BOLIVARIAN REPUBLIC OF', 'PARAGUAY', 'URUGUAY',
                                 'BOLIVIA, PLURINATIONAL STATE OF', 'GUYANA', 'SURINAME', 'BOLIVARIAN REPUBLIC OF',
                                 'BOLIVIA', 'FRENCH GUIANA'],
               'Europe': ['UNITED KINGDOM', 'GERMANY', 'FRANCE', 'ITALY', 'SPAIN', 'POLAND', 'BELGIUM', 'NETHERLANDS',
                          'SWEDEN', 'AUSTRIA', 'SWITZERLAND', 'GREECE', 'IRELAND', 'HUNGARY', 'ROMANIA',
                          'CZECH REPUBLIC', 'SLOVAKIA', 'DENMARK', 'FINLAND', 'NORWAY', 'LITHUANIA', 'BELARUS',
                          'UKRAINE', 'ESTONIA', 'LATVIA', 'CROATIA', 'BOSNIA AND HERZEGOVINA', 'ALBANIA', 'SERBIA',
                          'BULGARIA', 'SLOVENIA', 'MALTA', 'MOLDOVA, REPUBLIC OF',
                          'MACEDONIA, THE FORMER YUGOSLAV REPUBLIC OF', 'ICELAND', 'LUXEMBOURG', 'ANDORRA',
                          'SAN MARINO', 'MONACO', 'LIECHTENSTEIN', 'MONTENEGRO', 'TURKEY', 'DE', 'FR', 'GB', 'IT', 'ES',
                          'NL', 'BE', 'SE', 'AT', 'DK', 'FI', 'IE', 'PT'],
               'EU': ['AUSTRIA', 'BELGIUM', 'BULGARIA', 'CROATIA', 'CYPRUS', 'CZECH REPUBLIC', 'DENMARK', 'ESTONIA',
                      'FINLAND', 'FRANCE', 'GERMANY', 'GREECE', 'HUNGARY', 'IRELAND', 'ITALY', 'LATVIA', 'LITHUANIA',
                      'LUXEMBOURG', 'MALTA', 'NETHERLANDS', 'POLAND', 'PORTUGAL', 'ROMANIA', 'SLOVAKIA', 'SLOVENIA',
                      'SPAIN', 'SWEDEN'],
               'Asia': ['RUSSIAN FEDERATION', 'CHINA', 'JAPAN', 'INDIA', 'KAZAKHSTAN', 'THAILAND', 'MALAYSIA',
                        'SINGAPORE', 'PHILIPPINES', 'VIETNAM, DEMOCRATIC REP. OF', 'MYANMAR', 'AFGHANISTAN', 'PAKISTAN',
                        'BANGLADESH', 'NEPAL', 'SRI LANKA', 'TAIWAN, PROVINCE OF CHINA', 'HONG KONG', 'MONGOLIA',
                        'CAMBODIA', 'LAO PEOPLE`S DEMOCRATIC REPUBLIC', 'KOREA, REPUBLIC OF',
                        'KOREA, DEMOCRATIC PEOPLE`S REPUBLIC OF', 'BRUNEI DARUSSALAM', 'INDONESIA', 'MALDIVES',
                        'BHUTAN', 'TIMOR-LESTE', 'ARMENIA', 'AZERBAIJAN', 'GEORGIA'],
               'Middle East': ['IRAN, ISLAMIC REPUBLIC OF', 'SAUDI ARABIA', 'UNITED ARAB EMIRATES', 'ISRAEL', 'JORDAN',
                               'LEBANON', 'OMAN', 'QATAR', 'KUWAIT', 'BAHRAIN', 'IRAQ', 'YEMEN, DEMOCRATIC',
                               'SYRIAN ARAB REPUBLIC', 'SYRIA', 'PALESTINE, STATE OF', 'CYPRUS', 'PALESTINE STATE'],
               'Africa': ['SOUTH AFRICA', 'NIGERIA', 'GHANA', 'MOROCCO', 'ALGERIA', 'TUNISIA', 'LIBYA', 'SUDAN',
                          'SENEGAL', 'MALI', 'GUINEA', 'COTE D`IVOIRE', 'BURKINA FASO', 'NIGER', 'TOGO', 'BENIN',
                          'MAURITANIA', 'LIBERIA', 'SIERRA LEONE', 'GUINEA-BISSAU', 'GAMBIA', 'CAPE VERDE', 'ETHIOPIA',
                          'EGYPT', 'DR CONGO', 'CONGO', 'ANGOLA', 'KENYA', 'UGANDA', 'TANZANIA, UNITED REPUBLIC OF',
                          'RWANDA', 'BURUNDI', 'DJIBOUTI', 'ERITREA', 'SOMALIA', 'COMOROS', 'MAURITIUS', 'SEYCHELLES',
                          'MADAGASCAR', 'ZIMBABWE', 'ZAMBIA', 'MALAWI', 'SOUTH SUDAN', 'BOTSWANA', 'NAMIBIA', 'LESOTHO',
                          'SWAZILAND', 'MOZAMBIQUE', 'MALAGASY REPUBLIC', 'REUNION', 'MAYOTTE'],
               'Oceania': ['AUSTRALIA', 'NEW ZEALAND', 'PAPUA NEW GUINEA', 'VANUATU', 'SOLOMON ISLANDS', 'GUAM',
                           'KIRIBATI', 'MICRONESIA, FEDERATED STATES OF', 'PALAU', 'MARSHALL ISLANDS', 'SAMOA', 'FIJI',
                           'TONGA', 'TUVALU', 'NAURU', 'COOK ISLANDS', 'NIUE', 'AMERICAN SAMOA', 'FRENCH POLYNESIA',
                           'NEW CALEDONIA', 'WALLIS AND FUTUNA'],

               }

    # Initialize an empty list to store the result
    result = []

    # Iterate through each country/continent in the multilist
    for item in multilist:
        # Check if the item exists as a key in the dictionary (i.e., it's a continent or abbreviation)
        if item in mapping:
            # Extend the result list with all countries under this continent/abbreviation
            result.extend(mapping[item])
        else:
            # Check if the item exists as a country in any of the dictionary values
            for countries in mapping.values():
                if item in countries:
                    result.append(item)

    # making the list upper case
    result = [x.upper() for x in result]

    return list(set(result))
